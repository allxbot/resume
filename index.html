<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <title>Resume Loading...</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = { 
            theme: { 
                extend: { 
                    colors: { 
                        // --- è¯­ä¹‰åŒ–é¢œè‰²æ˜ å°„ (Semantic Colors) ---
                        // è¿™äº›ç±»åå¯¹åº” CSS å˜é‡ï¼Œå®ç°ä¸€é”®æ¢è‚¤
                        theme: {
                            page: 'var(--bg-page)',       /* é¡µé¢èƒŒæ™¯ */
                            card: 'var(--bg-card)',       /* å¡ç‰‡èƒŒæ™¯ */
                            subtle: 'var(--bg-subtle)',   /* æ¬¡çº§èƒŒæ™¯(å¦‚åº•æ ) */
                            hover: 'var(--bg-hover)',     /* æ‚¬åœèƒŒæ™¯ */
                            
                            title: 'var(--text-title)',   /* ä¸»æ ‡é¢˜ */
                            body: 'var(--text-body)',     /* æ­£æ–‡ */
                            muted: 'var(--text-muted)',   /* å¼±åŒ–æ–‡å­— */
                            accent: 'var(--text-accent)', /* å¼ºè°ƒè‰²(é“¾æ¥/é«˜äº®) */
                            
                            btn: 'var(--btn-bg)',         /* æŒ‰é’®èƒŒæ™¯ */
                            'btn-txt': 'var(--btn-text)', /* æŒ‰é’®æ–‡å­— */
                            
                            border: 'var(--border-color)',/* è¾¹æ¡†è‰² */
                            line: 'var(--line-color)',    /* æ—¶é—´è½´çº¿ */
                            
                            // åŠŸèƒ½è‰²
                            'tag-bg': 'var(--tag-bg)',    /* æ ‡ç­¾èƒŒæ™¯ */
                            'tag-txt': 'var(--tag-txt)',  /* æ ‡ç­¾æ–‡å­— */
                            'icon-def': 'var(--icon-def)' /* é»˜è®¤å›¾æ ‡è‰² */
                        }
                    },
                    boxShadow: { 
                        'theme': 'var(--shadow-card)',
                        'theme-hover': 'var(--shadow-hover)'
                    },
                    borderRadius: {
                        'theme': 'var(--radius-card)',
                        'btn': 'var(--radius-btn)'
                    },
                    fontFamily: {
                        'theme': 'var(--font-family)'
                    }
                } 
            } 
        }
    </script>

    <style type="text/tailwindcss">
        @layer utilities { 
            /* è¿›åº¦æ¡æ¸å˜ */
            .progress-bar { height: 6px; background: linear-gradient(90deg, var(--text-accent) var(--progress), var(--bg-subtle) var(--progress)); border-radius: 4px; } 
            
            /* ç»ç’ƒæ‹Ÿæ€é€šç”¨ç±» */
            .glass-effect {
                background-color: var(--glass-bg);
                backdrop-filter: blur(var(--glass-blur));
            }
        }

        /* =================================================================
           ğŸ¨ æ ·å¼æ¨¡ç‰ˆå®šä¹‰ (Style Templates)
           æ‰€æœ‰è§†è§‰ç‰¹å¾å‡åœ¨æ­¤å®šä¹‰ï¼ŒHTMLåªè´Ÿè´£ç»“æ„
           ================================================================= */

        /* ---------------- 1. ï£¿ Apple Style (Reference: Apple Official) ---------------- */
        :root[data-theme='apple'] {
            /* [å­—ä½“] SF Pro / Inter, ç´§å‡‘ä¸”æ¸…æ™° */
            --font-family: 'Inter', -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
            
            /* [èƒŒæ™¯] Apple æ ‡å¿—æ€§çš„ç°ç™½è°ƒ */
            --bg-page: #f5f5f7;       /* å®˜ç½‘èƒŒæ™¯ç° */
            --bg-card: #ffffff;       /* çº¯ç™½å¡ç‰‡ */
            --bg-subtle: #f5f5f7;     /* æµ…ç°åŒºå— */
            --bg-hover: #fbfbfd;      /* æ‚¬åœå¾®äº® */
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-blur: 20px;
            --hero-glow: rgba(0, 113, 227, 0.15); /* é¡¶éƒ¨è“è‰²å…‰æ™• */

            /* [æ–‡å­—] é«˜å¯¹æ¯”åº¦ç°é˜¶ */
            --text-title: #1d1d1f;    /* æ¥è¿‘çº¯é»‘çš„æ·±ç° */
            --text-body: #424245;     /* æ¬¡çº§æ·±ç°ï¼Œé˜…è¯»èˆ’é€‚ */
            --text-muted: #86868b;    /* æµ…ç°ï¼Œç”¨äºè¾…åŠ©ä¿¡æ¯ */
            --text-accent: #0066cc;   /* Apple Link Blue */

            /* [ç»„ä»¶] */
            --btn-bg: #1d1d1f;        /* é»‘è‰²æŒ‰é’® */
            --btn-text: #ffffff;
            --tag-bg: #e8e8ed;        /* æ ‡ç­¾æµ…ç°åº• */
            --tag-txt: #1d1d1f;
            
            /* [çº¿æ¡ä¸è¾¹æ¡†] */
            --border-color: rgba(0,0,0,0.0); /* Appleé£æ ¼é€šå¸¸æ— è¾¹æ¡†ï¼Œé é˜´å½± */
            --line-color: #d2d2d7;    /* æ—¶é—´è½´çº¿ */
            
            /* [å›¾æ ‡] */
            --icon-def: #1d1d1f;
            --check-color: #86868b;

            /* [å½¢çŠ¶] */
            --radius-card: 1.5rem;    /* é€‚ä¸­çš„å¤§åœ†è§’ */
            --radius-btn: 9999px;     /* èƒ¶å›ŠæŒ‰é’® */
            --shadow-card: 0 4px 12px rgba(0,0,0,0.08); /* æŸ”å’Œå¼¥æ•£é˜´å½± */
            --shadow-hover: 0 8px 24px rgba(0,0,0,0.12);
        }

        /* ---------------- 2. ğŸ”· Modern Theme (SaaS/Clean) ---------------- */
        :root[data-theme='modern'] {
            --font-family: 'Inter', sans-serif;
            
            --bg-page: #f8fafc;       /* è“è°ƒç°ç™½ */
            --bg-card: #ffffff;
            --bg-subtle: #f1f5f9;
            --bg-hover: #ffffff;
            --glass-bg: rgba(255, 255, 255, 0.9);
            --glass-blur: 0px;
            --hero-glow: rgba(59, 130, 246, 0.1);

            --text-title: #0f172a;    /* Slate-900 */
            --text-body: #334155;     /* Slate-700 */
            --text-muted: #64748b;    /* Slate-500 */
            --text-accent: #3b82f6;   /* Blue-500 */

            --btn-bg: #3b82f6;
            --btn-text: #ffffff;
            --tag-bg: #eff6ff;
            --tag-txt: #1d4ed8;

            --border-color: #e2e8f0;
            --line-color: #cbd5e1;
            
            --icon-def: #3b82f6;
            --check-color: #3b82f6;

            --radius-card: 0.75rem;   /* æ ‡å‡†åœ†è§’ */
            --radius-btn: 0.5rem;
            --shadow-card: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-hover: 0 10px 15px -3px rgba(0,0,0,0.1);
        }

        /* ---------------- 3. ğŸ© Classic Theme (Business/Serif) ---------------- */
        :root[data-theme='classic'] {
            --font-family: 'Playfair Display', serif; /* è¡¬çº¿ä½“ */
            
            --bg-page: #fafaf9;       /* æš–è‰²è°ƒç™½ */
            --bg-card: #ffffff;
            --bg-subtle: #f5f5f4;
            --bg-hover: #ffffff;
            --glass-bg: #ffffff;
            --glass-blur: 0px;
            --hero-glow: rgba(120, 113, 108, 0.1);

            --text-title: #1c1917;    /* Stone-900 */
            --text-body: #44403c;     /* Stone-700 */
            --text-muted: #78716c;    /* Stone-500 */
            --text-accent: #b45309;   /* Amber-700 */

            --btn-bg: #1c1917;
            --btn-text: #ffffff;
            --tag-bg: #f5f5f4;
            --tag-txt: #1c1917;

            --border-color: #d6d3d1;
            --line-color: #d6d3d1;
            
            --icon-def: #b45309;
            --check-color: #b45309;

            --radius-card: 2px;       /* è¿‘ä¹ç›´è§’ */
            --radius-btn: 2px;
            --shadow-card: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-hover: 0 4px 6px -1px rgba(0,0,0,0.1);
        }

        /* ---------------- 4. ğŸ’» Geek Theme (Terminal) ---------------- */
        :root[data-theme='geek'] {
            --font-family: 'JetBrains Mono', monospace;
            
            --bg-page: #0d1117;       /* GitHub Dark Dimmed */
            --bg-card: #161b22;
            --bg-subtle: #0d1117;
            --bg-hover: #161b22;
            --glass-bg: #161b22;
            --glass-blur: 0px;
            --hero-glow: rgba(46, 160, 67, 0.1);

            --text-title: #e6edf3;    /* äº®ç™½ */
            --text-body: #8b949e;     /* ç»ˆç«¯ç° */
            --text-muted: #6e7681;
            --text-accent: #2ea043;   /* Terminal Green */

            --btn-bg: #238636;
            --btn-text: #ffffff;
            --tag-bg: #1f6feb;        /* Blue accent for tags */
            --tag-txt: #ffffff;

            --border-color: #30363d;
            --line-color: #30363d;
            
            --icon-def: #2ea043;
            --check-color: #2ea043;

            --radius-card: 6px;
            --radius-btn: 6px;
            --shadow-card: none;
            --shadow-hover: 0 0 0 2px #2ea043; /* ç»¿è‰²æè¾¹ */
        }

        /* ---------------- 5. ğŸŒ‘ Dark Theme (New! Premium Dark) ---------------- */
        :root[data-theme='dark'] {
            --font-family: 'Inter', sans-serif;
            
            --bg-page: #000000;       /* çº¯é»‘ */
            --bg-card: #1c1c1e;       /* Apple Dark Grey */
            --bg-subtle: #1c1c1e;
            --bg-hover: #2c2c2e;
            --glass-bg: rgba(28, 28, 30, 0.8);
            --glass-blur: 20px;
            --hero-glow: rgba(255, 255, 255, 0.1);

            --text-title: #f5f5f7;    /* äº®ç™½ */
            --text-body: #d1d1d6;     /* æµ…ç° */
            --text-muted: #86868b;    /* æš—ç° */
            --text-accent: #0a84ff;   /* iOS Dark Blue */

            --btn-bg: #ffffff;        /* ç™½è‰²æŒ‰é’® */
            --btn-text: #000000;
            --tag-bg: #2c2c2e;
            --tag-txt: #f5f5f7;

            --border-color: #38383a;
            --line-color: #38383a;
            
            --icon-def: #0a84ff;
            --check-color: #86868b;

            --radius-card: 1.5rem;
            --radius-btn: 9999px;
            --shadow-card: 0 0 0 1px rgba(255,255,255,0.1); /* å¾®å¼±ç™½è¾¹æ›¿ä»£é˜´å½± */
            --shadow-hover: 0 0 0 1px rgba(255,255,255,0.3);
        }

        /* --- å…¨å±€æ ·å¼é‡ç½® --- */
        body {
            font-family: var(--font-family);
            background-color: var(--bg-page);
            color: var(--text-body);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        h1, h2, h3, h4, h5, h6 { color: var(--text-title); }
        
        /* äº¤äº’ç±» */
        .card-base {
            background-color: var(--bg-card);
            border-radius: var(--radius-card);
            box-shadow: var(--shadow-card);
            border: 1px solid var(--border-color);
        }
        .card-base:hover { box-shadow: var(--shadow-hover); }

        .btn-main {
            background-color: var(--btn-bg);
            color: var(--btn-text);
            border-radius: var(--radius-btn);
        }
        .btn-ghost {
            background-color: var(--bg-card);
            color: var(--text-title);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-btn);
        }

        /* åŠ¨ç”»ç±» */
        .reveal-hidden { opacity: 0; transform: translateY(30px) scale(0.98); transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1); will-change: transform, opacity; }
        .reveal-visible { opacity: 1; transform: translateY(0) scale(1); }
        .tilt-container { perspective: 1000px; transform-style: preserve-3d; }

        /* æ‰“å°æ ·å¼ (ä¿æŒä¸å˜ï¼Œä½¿ç”¨é»‘ç™½é«˜å¯¹æ¯”) */
        #print-view { display: none; }
        @media print {
            #screen-view, header, #backToTop, #wechatModal, .no-print, .tilt-container { display: none !important; }
            @page { size: A4; margin: 15mm 15mm; }
            html, body { width: 210mm; height: auto; margin: 0 !important; padding: 0 !important; background-color: white !important; color: #000 !important; overflow: visible !important; font-family: "Microsoft YaHei", sans-serif !important; }
            #print-view { display: block !important; width: 100%; font-size: 9.5pt; line-height: 1.35; text-align: justify; }
            .print-h1 { font-size: 20pt; font-weight: bold; line-height: 1.2; margin-bottom: 4pt; color: #000; }
            .print-h2 { font-size: 12pt; font-weight: bold; border-bottom: 1pt solid #000; margin-top: 10pt; margin-bottom: 4pt; padding-bottom: 2pt; page-break-after: avoid; }
            .print-h3 { font-size: 10pt; font-weight: bold; margin-top: 6pt; margin-bottom: 2pt; display: flex; justify-content: space-between; page-break-after: avoid; }
            .print-meta { font-size: 9pt; margin-bottom: 8pt; line-height: 1.4; }
            .print-table { width: 100%; border-collapse: collapse; margin-bottom: 8pt; font-size: 9pt; page-break-inside: auto; }
            .print-table th, .print-table td { border: 1pt solid #333; padding: 3pt 5pt; vertical-align: top; }
            .print-table td:first-child { font-weight: bold; white-space: nowrap; background-color: #f2f2f2 !important; width: 1%; }
            .print-list { list-style-type: disc; padding-left: 1.2em; margin-top: 2pt; margin-bottom: 0; }
            .print-list li { margin-bottom: 2pt; }
            .job-sub-row { font-weight: bold; font-size: 9.5pt; margin-bottom: 3pt; display: flex; justify-content: space-between; border-bottom: 0.5pt dashed #999; padding-bottom: 2pt; }
            .job-phase-title { font-weight: bold; margin-top: 4pt; margin-bottom: 2pt; font-size: 9.5pt; }
            section, .print-section { page-break-inside: auto !important; break-inside: auto !important; }
            .no-break { page-break-inside: auto; break-inside: auto; margin-bottom: 8pt; }
            a { text-decoration: none !important; color: #000 !important; }
        }
        #mobile-menu { transition: max-height 0.4s; max-height: 0; opacity: 0; overflow: hidden; }
        #mobile-menu.open { max-height: 400px; opacity: 1; }
    </style>
</head>
<body class="selection:bg-theme-accent/20 selection:text-theme-accent font-theme">

    <div id="screen-view">
        <header id="navbar" class="fixed w-full top-0 left-0 transition-all duration-300 z-50 py-4 bg-transparent print:hidden">
            <div class="container mx-auto px-4 md:px-6">
                <div class="flex justify-between items-center">
                    <a href="#" class="text-xl font-bold text-theme-title tracking-tight flex items-center gap-2" id="nav-name"></a>
                    <div class="hidden md:flex items-center gap-1 px-2" id="nav-pill">
                        <nav class="flex text-sm font-medium text-theme-body space-x-1" id="nav-menu-desktop"></nav>
                        <div class="w-px h-4 bg-theme-border mx-3"></div>
                        <button id="langSwitch" class="flex items-center gap-1 px-3 py-1.5 rounded-full text-xs font-semibold hover:bg-theme-hover transition text-theme-body hover:text-theme-title border border-transparent">
                            <i class="fa fa-globe"></i> <span id="langLabel">EN</span>
                        </button>
                    </div>
                    <div class="flex items-center gap-4 md:hidden">
                        <button id="langSwitchMobile" class="border border-theme-border px-2 py-1 rounded text-xs font-medium hover:border-theme-accent text-theme-body">
                            <span id="langLabelMobile">EN</span>
                        </button>
                        <button id="mobile-menu-btn" class="text-theme-body hover:text-theme-title focus:outline-none transition p-1"><i class="fa fa-bars text-2xl"></i></button>
                    </div>
                </div>
                <div id="mobile-menu" class="md:hidden border-t mt-3 border-theme-border">
                    <nav class="flex flex-col space-y-2 py-4" id="nav-menu-mobile"></nav>
                </div>
            </div>
        </header>

        <section class="pt-40 pb-20 relative overflow-hidden print:pt-10">
            <div id="hero-bg-blur" class="absolute top-0 left-1/2 -translate-x-1/2 w-[1000px] h-[600px] rounded-[100%] blur-3xl -z-10 opacity-60 print:hidden transition-colors" style="background: linear-gradient(to bottom, var(--hero-glow), transparent);"></div>
            
            <div class="container mx-auto px-4 md:px-6 flex flex-col md:flex-row items-center gap-12 md:gap-20">
                <div class="md:w-1/2 text-center md:text-left z-10">
                    <h1 class="text-4xl md:text-6xl font-bold text-theme-title mb-6 leading-tight tracking-tight reveal-hidden" id="hero-name"></h1>
                    <p class="text-xl md:text-2xl text-theme-muted mb-8 font-light reveal-hidden" style="transition-delay: 100ms" id="hero-title"></p>
                    <div class="flex flex-wrap justify-center md:justify-start gap-3 mb-10 reveal-hidden" style="transition-delay: 200ms" id="hero-tags"></div>
                    <div class="flex flex-wrap justify-center md:justify-start gap-4 print:hidden reveal-hidden" style="transition-delay: 300ms" id="hero-btns"></div>
                </div>
                <div class="md:w-1/2 flex justify-center tilt-container reveal-hidden" style="transition-delay: 200ms">
                    <div id="hero-tilt" class="relative w-64 h-64 md:w-80 md:h-80 transition-transform duration-100 ease-out cursor-pointer group">
                        <div class="absolute inset-0 rounded-full bg-gradient-to-tr from-theme-accent/20 to-theme-accent/5 blur-2xl opacity-40 group-hover:opacity-60 transition-opacity duration-500 print:hidden"></div>
                        <div class="w-full h-full rounded-full bg-theme-card p-1.5 shadow-theme relative overflow-hidden border border-white/20">
                            <img id="hero-avatar" src="" alt="Profile" class="w-full h-full rounded-full object-cover">
                        </div>
                        <div class="absolute bottom-4 right-4 bg-theme-card/90 backdrop-blur shadow-lg px-4 py-2 rounded-full border border-theme-border flex items-center gap-2 transform translate-z-10 group-hover:scale-105 transition print:hidden">
                            <i class="fa fa-map-marker text-red-500"></i>
                            <span class="text-xs font-semibold text-theme-title" id="hero-location"></span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="profile" class="py-20 glass-effect reveal-hidden print:py-5">
            <div class="container mx-auto px-4 md:px-6 max-w-5xl">
                <div class="text-center mb-12"><h2 class="text-3xl font-bold text-theme-title" id="t-profile"></h2></div>
                <div class="card-base p-8 md:p-12">
                    <p class="text-theme-body mb-10 leading-relaxed text-lg" id="profile-summary"></p>
                    <div class="grid md:grid-cols-3 gap-6" id="profile-cards"></div>
                </div>
            </div>
        </section>

        <section id="skills" class="py-20 reveal-hidden print:py-5 print:break-inside-avoid">
            <div class="container mx-auto px-4 md:px-6">
                <div class="text-center mb-12"><h2 class="text-3xl font-bold text-theme-title" id="t-skills"></h2></div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-6" id="skills-bento-container"></div>
            </div>
        </section>

        <section id="experience" class="py-20 glass-effect print:py-5">
            <div class="container mx-auto px-4 md:px-6">
                <div class="text-center mb-16"><h2 class="text-3xl font-bold text-theme-title" id="t-exp"></h2></div>
                <div class="max-w-5xl mx-auto space-y-12" id="exp-list"></div>
            </div>
        </section>

        <section id="education" class="py-20 print:py-5 print:break-inside-avoid">
            <div class="container mx-auto px-4 md:px-6">
                <div class="text-center mb-16"><h2 class="text-3xl font-bold text-theme-title" id="t-edu"></h2></div>
                <div class="grid md:grid-cols-2 gap-8" id="edu-container">
                    <div class="card-base p-8 h-full reveal-hidden" id="edu-col-left"></div>
                    <div class="card-base p-8 h-full reveal-hidden" style="transition-delay: 100ms" id="edu-col-right"></div>
                </div>
            </div>
        </section>

        <section id="contact" class="py-24 border-t border-theme-border print:py-5 print:break-inside-avoid bg-theme-card">
            <div class="container mx-auto px-4 md:px-6">
                <div class="max-w-4xl mx-auto bg-theme-subtle card-base shadow-inner p-8 md:p-12 reveal-hidden" id="contact-area"></div>
            </div>
        </section>

        <footer class="bg-theme-subtle text-theme-muted py-12 print:hidden text-center border-t border-theme-border">
            <h3 class="text-lg font-bold text-theme-title mb-2" id="f-name"></h3>
            <p class="text-sm mb-6" id="f-desc"></p>
            <div class="flex justify-center space-x-6 mb-8" id="social-icons"></div>
            <p class="text-xs opacity-60">Â© 2026 <span id="copyright-name"></span>. All rights reserved.</p>
        </footer>

        <button id="backToTop" class="fixed bottom-8 right-8 w-12 h-12 bg-theme-card backdrop-blur-md border border-theme-border rounded-full shadow-lg flex items-center justify-center text-theme-muted hover:text-theme-title hover:scale-110 hover:-translate-y-1 transition-all duration-500 z-40 opacity-0 invisible translate-y-4 group">
            <i class="fa fa-arrow-up transition-transform duration-300 group-hover:-translate-y-0.5"></i>
        </button>

        <div id="wechatModal" class="hidden fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-md p-4 transition-opacity duration-300" onclick="this.classList.add('hidden')">
            <div class="bg-theme-card p-8 rounded-theme shadow-2xl max-w-sm w-full text-center transform scale-100 transition-transform duration-300" onclick="event.stopPropagation()">
                <h3 id="modal-title" class="text-xl font-bold mb-6 text-theme-title">Scan QR Code</h3>
                <div class="bg-gray-100 p-3 rounded-xl inline-block mb-6 shadow-inner">
                    <img id="modal-qr" src="" class="w-48 h-48 object-contain mix-blend-multiply">
                </div>
                <p class="text-theme-body font-mono text-sm bg-theme-subtle py-2 px-4 rounded-lg border border-theme-border inline-block" id="modal-text"></p>
                <div class="mt-8"><button onclick="document.getElementById('wechatModal').classList.add('hidden')" class="text-sm font-medium text-theme-accent hover:underline px-4 py-2 rounded-full transition">Close</button></div>
            </div>
        </div>
    </div>
    
    <div id="print-view"></div>

    <script>
        let currentLang = localStorage.getItem('lang') || 'zh';
        let myChart = null;

        function stripHtml(html) { let tmp = document.createElement("DIV"); tmp.innerHTML = html; return tmp.textContent || tmp.innerText || ""; }

        document.addEventListener('DOMContentLoaded', () => {
            loadResume();
            document.getElementById('langSwitch').addEventListener('click', toggleLanguage);
            document.getElementById('langSwitchMobile').addEventListener('click', toggleLanguage);
            
            const navbar = document.getElementById('navbar');
            const mobileMenu = document.getElementById('mobile-menu');
            window.addEventListener('scroll', () => {
                const isScrolled = window.scrollY > 50;
                const isMenuOpen = mobileMenu.classList.contains('open');
                if (isScrolled || isMenuOpen) {
                    navbar.classList.remove('bg-transparent', 'py-4');
                    navbar.classList.add('bg-theme-page/90', 'backdrop-blur-xl', 'border-b', 'border-theme-border', 'py-3');
                } else {
                    navbar.classList.add('bg-transparent', 'py-4');
                    navbar.classList.remove('bg-theme-page/90', 'backdrop-blur-xl', 'border-b', 'border-theme-border', 'py-3');
                }
                
                const backToTop = document.getElementById('backToTop');
                if (window.scrollY > 300) { backToTop.classList.remove('opacity-0', 'invisible', 'translate-y-4'); backToTop.classList.add('opacity-100', 'visible', 'translate-y-0'); } 
                else { backToTop.classList.add('opacity-0', 'invisible', 'translate-y-4'); backToTop.classList.remove('opacity-100', 'visible', 'translate-y-0'); }
            });
            document.getElementById('mobile-menu-btn').addEventListener('click', () => { mobileMenu.classList.toggle('open'); });
            document.getElementById('backToTop').addEventListener('click', () => { window.scrollTo({ top: 0, behavior: 'smooth' }); });
        });

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('reveal-visible'); observer.unobserve(entry.target); } });
        }, { threshold: 0.1 });

        // Cache Busting: æ·»åŠ æ—¶é—´æˆ³é˜²æ­¢ç¼“å­˜
        async function loadResume() {
            try {
                // å¼ºåˆ¶åˆ·æ–°æ•°æ®
                const res = await fetch(`./data.json?t=${new Date().getTime()}`);
                const fullData = await res.json();
                const data = fullData[currentLang];
                
                const theme = fullData[currentLang].ui.theme || 'apple';
                document.documentElement.setAttribute('data-theme', theme);
                
                if(fullData['en']) document.getElementById('copyright-name').textContent = fullData['en'].basic_info.name;
                render(data, theme);
                renderPrintView(data, fullData[currentLang].ui); 
                
                setTimeout(() => { document.querySelectorAll('.reveal-hidden').forEach(el => observer.observe(el)); }, 100);
            } catch(e) { console.error(e); }
        }

        function toggleLanguage() {
            currentLang = currentLang === 'zh' ? 'en' : 'zh';
            localStorage.setItem('lang', currentLang);
            loadResume();
        }

        function render(data, theme) {
            const basic = data.basic_info;
            const ui = data.ui;
            const labelLang = currentLang === 'zh' ? 'EN' : 'ä¸­æ–‡';
            
            document.title = `${basic.name} - ${currentLang === 'zh' ? 'ç®€å†' : 'Resume'}`;
            document.getElementById('langLabel').textContent = labelLang;
            document.getElementById('langLabelMobile').textContent = labelLang;
            document.getElementById('nav-name').textContent = basic.name;
            
            const links = ['profile','skills','experience','education','contact'];
            const navHTML = ui.nav.map((n, i) => `<a href="#${links[i]}" class="px-3 py-2 rounded-full hover:bg-theme-subtle hover:text-theme-title transition-colors rounded-btn" onclick="document.getElementById('mobile-menu').classList.remove('open');">${n}</a>`).join('');
            document.getElementById('nav-menu-desktop').innerHTML = navHTML;
            document.getElementById('nav-menu-mobile').innerHTML = navHTML;

            document.getElementById('hero-name').textContent = basic.name;
            document.getElementById('hero-title').textContent = basic.titles;
            document.getElementById('hero-tags').innerHTML = basic.tags.map(t => `<span class="bg-theme-tag-bg border border-theme-border text-theme-tag-txt px-4 py-1.5 rounded-full text-sm font-medium shadow-sm">${t}</span>`).join('');
            
            // æŒ‰é’®: ä½¿ç”¨è¯­ä¹‰ç±»å btn-main / btn-ghost
            document.getElementById('hero-btns').innerHTML = `
                <a href="#contact" class="btn-main px-8 py-3 font-medium hover:opacity-90 hover:scale-105 transition-all duration-300 shadow-lg flex items-center"><i class="fa fa-envelope mr-2"></i> ${ui.buttons.contact}</a>
                <a href="#experience" class="btn-ghost px-8 py-3 font-medium hover:bg-theme-subtle transition-all hover:scale-105 shadow-sm flex items-center"><i class="fa fa-briefcase mr-2"></i> ${ui.buttons.exp}</a>
                <button onclick="window.print()" class="btn-ghost px-8 py-3 font-medium hover:bg-theme-subtle transition-all hover:scale-105 shadow-sm flex items-center gap-2"><i class="fa fa-print"></i> ${ui.buttons.print}</button>
            `;
            document.getElementById('hero-avatar').src = basic.avatar;
            document.getElementById('hero-location').textContent = basic.location;

            document.getElementById('t-profile').textContent = ui.section_titles.profile;
            document.getElementById('profile-summary').innerHTML = data.profile.summary;
            document.getElementById('profile-cards').innerHTML = data.profile.cards.map((c, i) => `
                <div class="group bg-theme-subtle rounded-theme p-6 transition-all duration-300 reveal-hidden hover:bg-theme-card hover:shadow-theme-hover border border-transparent hover:border-theme-border" style="transition-delay: ${i*100}ms">
                    <div class="w-10 h-10 rounded-xl bg-blue-100 text-blue-600 flex items-center justify-center text-lg mb-4 group-hover:scale-110 transition-transform"><i class="fa ${c.icon}"></i></div>
                    <h3 class="font-bold text-theme-title mb-2">${c.title}</h3>
                    <p class="text-sm text-theme-body leading-relaxed">${c.desc}</p>
                </div>`).join('');

            document.getElementById('t-skills').textContent = ui.section_titles.skills;
            const bentoContainer = document.getElementById('skills-bento-container');
            const chartData = data.skills.chart;
            
            let bentoHTML = `
                <div class="col-span-1 md:col-span-1 lg:col-span-3 card-base p-6 flex flex-col relative overflow-hidden reveal-hidden">
                    <div class="flex items-center gap-3 mb-4 z-10">
                        <div class="w-8 h-8 rounded-lg bg-blue-50 text-blue-600 flex items-center justify-center"><i class="fa fa-pie-chart"></i></div>
                        <h3 class="font-bold text-theme-title">${ui.section_titles.chart} (Radar)</h3>
                    </div>
                    <div class="flex-1 min-h-[300px] flex items-center justify-center min-w-0">
                        <div class="relative w-full h-full">
                            <canvas id="skillsChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="col-span-1 md:col-span-1 lg:col-span-3 card-base p-6 reveal-hidden">
                    <div class="flex items-center gap-3 mb-6 pb-3 border-b border-theme-border">
                        <div class="w-8 h-8 rounded-lg bg-green-50 text-green-600 flex items-center justify-center"><i class="fa fa-sliders"></i></div>
                        <h3 class="font-bold text-theme-title">${ui.section_titles.chart} (Levels)</h3>
                    </div>
                    <div class="space-y-6">
                        ${chartData.labels.map((l, i) => `
                            <div>
                                <div class="flex justify-between mb-1.5 text-sm font-semibold text-theme-body">
                                    <span>${l}</span>
                                    <span class="text-theme-accent">${chartData.data[i]}%</span>
                                </div>
                                <div class="progress-bar" style="--progress:${chartData.data[i]}%"></div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            // å›¾æ ‡é¢œè‰²å¾ªç¯ logic now handled by CSS variables --ico-1, 2, 3
            // In Apple theme, these are Orange, Purple, Teal. In others, they are monochrome.
            const iconVars = ['text-ico-1', 'text-ico-2', 'text-ico-3'];
            data.skills.card_groups.forEach((g, idx) => {
                bentoHTML += `
                <div class="col-span-1 md:col-span-1 lg:col-span-2 card-base p-6 hover:-translate-y-1 transition-all duration-300 reveal-hidden" style="transition-delay: ${(idx+1)*100}ms">
                    <div class="flex items-center gap-3 mb-4 pb-3 border-b border-theme-border">
                        <i class="fa ${g.icon} ${iconVars[idx%3]} text-lg"></i>
                        <h3 class="font-bold text-theme-title">${g.title}</h3>
                    </div>
                    <ul class="space-y-3">
                        ${g.items.slice(0, 5).map(item => `<li class="flex items-start gap-2 text-sm text-theme-body"><span class="w-1.5 h-1.5 rounded-full bg-gray-300 mt-1.5 shrink-0"></span><span class="leading-snug">${stripHtml(item)}</span></li>`).join('')}
                    </ul>
                </div>`;
            });
            bentoContainer.innerHTML = bentoHTML;

            if(myChart) myChart.destroy();
            const gridColor = theme === 'geek' || theme === 'dark' ? '#333' : '#f0f0f0';
            const pointColor = theme === 'geek' || theme === 'dark' ? '#fff' : '#333';
            
            myChart = new Chart(document.getElementById('skillsChart'), {
                type: 'radar',
                data: {
                    labels: chartData.labels,
                    datasets: [{ 
                        label: 'Level', 
                        data: chartData.data, 
                        backgroundColor: theme === 'geek' ? 'rgba(46, 160, 67, 0.2)' : 'rgba(0, 113, 227, 0.2)', 
                        borderColor: theme === 'geek' ? '#2ea043' : (theme === 'classic' ? '#1e3a8a' : '#0071e3'), 
                        pointBackgroundColor: pointColor, 
                        pointBorderColor: theme === 'geek' ? '#2ea043' : '#0071e3', 
                        borderWidth: 2 
                    }]
                },
                options: { 
                    responsive: true, maintainAspectRatio: false,
                    scales: { 
                        r: { 
                            min: 0, max: 100, 
                            ticks: { display: true, stepSize: 20, backdropColor: 'transparent', font: { size: 10 }, color: '#999' },
                            grid: { color: gridColor },
                            pointLabels: { font: { size: 12, weight: '600', family: 'var(--font-family)' }, color: 'var(--text-muted)' }
                        } 
                    }, 
                    plugins: { legend: { display: false }, tooltip: { callbacks: { label: (context) => context.raw + '%' } } } 
                }
            });

            document.getElementById('t-exp').textContent = ui.section_titles.experience;
            document.getElementById('exp-list').innerHTML = data.experience.map(job => `
                <div class="relative pl-0 md:pl-0 reveal-hidden">
                    <div class="flex flex-col md:flex-row gap-8 md:gap-16">
                        <div class="md:w-1/3 text-left md:text-right relative">
                            <div class="sticky top-28 transition-all">
                                <h3 class="font-bold text-2xl text-theme-title tracking-tight">${job.company}</h3>
                                <div class="text-date-txt font-semibold text-sm mt-1 mb-2 inline-block bg-date-bg px-3 py-1 rounded-full">${job.date}</div>
                                <p class="text-theme-body font-medium mb-1">${job.role}</p>
                                <p class="text-theme-muted text-xs flex items-center md:justify-end gap-1"><i class="fa fa-map-marker"></i> ${job.location}</p>
                            </div>
                        </div>
                        <div class="md:w-2/3 border-l-2 border-theme-line pl-8 py-2 space-y-8">
                            ${job.projects.map(p => `
                                <div class="group">
                                    ${p.title ? `<h4 class="font-bold text-theme-title mb-3 text-lg flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-theme-accent"></span> ${p.title}</h4>` : ''}
                                    <ul class="space-y-4">
                                        ${p.details.map(d => `<li class="flex items-start gap-3 text-[15px] text-theme-body leading-relaxed group-hover:text-theme-title transition-colors"><i class="fa fa-check mt-1 shrink-0 text-xs text-check"></i><span>${d}</span></li>`).join('')}
                                    </ul>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>`).join('');

            document.getElementById('t-edu').textContent = ui.section_titles.education;
            document.getElementById('edu-col-left').innerHTML = `
                <h3 class="font-bold text-xl mb-8 text-theme-title flex items-center gap-3"><span class="bg-blue-100 text-blue-600 w-8 h-8 rounded-lg flex items-center justify-center text-sm"><i class="fa fa-graduation-cap"></i></span> ${ui.section_titles.academic}</h3>
                <div class="space-y-8">
                ${data.education.map(e => `
                    <div><h4 class="font-bold text-lg text-theme-title">${e.school}</h4><p class="text-theme-body font-medium">${e.degree}</p><p class="text-theme-muted text-sm mt-1 flex items-center gap-2"><i class="fa fa-calendar-o"></i> ${e.date} &nbsp;â€¢&nbsp; ${e.location}</p></div>`).join('')}
                </div>
                <div class="mt-12 pt-8 border-t border-theme-border">
                    <h3 class="font-bold text-lg mb-4 text-theme-title flex items-center gap-2"><i class="fa fa-heart text-red-400"></i> ${ui.section_titles.hobbies}</h3>
                    <div class="flex flex-wrap gap-2 mb-4">${data.hobbies.items.map(h => `<span class="bg-theme-subtle px-3 py-1 rounded-full text-xs font-medium text-theme-body border border-transparent hover:border-theme-border transition">${h}</span>`).join('')}</div>
                    <p class="text-sm text-theme-body bg-theme-subtle p-4 rounded-xl italic border border-theme-border">"${data.hobbies.desc}"</p>
                </div>`;
            
            document.getElementById('edu-col-right').innerHTML = data.tools.map(t => `
                <div class="mb-8 last:mb-0">
                    <h3 class="font-bold text-lg mb-5 text-theme-title flex items-center gap-2"><i class="fa ${t.icon} text-theme-muted"></i> ${t.group}</h3>
                    <div class="grid grid-cols-2 gap-3">
                        ${t.list.map(i => `<div class="bg-theme-subtle px-4 py-3 rounded-xl text-sm font-medium text-theme-body border border-transparent hover:border-theme-border hover:bg-theme-card hover:shadow-sm transition-all cursor-default flex items-center gap-2"><i class="fa fa-check text-xs text-check"></i> ${i}</div>`).join('')}
                    </div>
                </div>`).join('');

            const cf = ui.contact_form; const cl = ui.contact_labels;
            const formAction = cf.form_id ? `https://formspree.io/f/${cf.form_id}` : '';
            const onSubmitAttr = formAction ? '' : `onsubmit="event.preventDefault(); alert('Please config Form ID')"`;
            document.getElementById('contact-area').innerHTML = `
                <div class="text-center mb-10"><h2 class="text-3xl font-bold text-theme-title mb-2">${ui.section_titles.contact}</h2></div>
                <div class="grid md:grid-cols-2 gap-12 items-stretch">
                    <div class="space-y-6 flex flex-col">
                         <div class="flex items-start gap-4 p-5 rounded-2xl bg-theme-card border border-theme-border shadow-sm hover:shadow-md transition">
                            <div class="w-10 h-10 rounded-full bg-purple-50 text-purple-500 flex items-center justify-center shrink-0"><i class="fa fa-briefcase"></i></div>
                            <div><div class="text-xs text-theme-muted uppercase font-bold tracking-wider mb-1">${basic.objective.label}</div>${basic.objective.items.map(o => `<div class="text-theme-title font-medium mb-1">${o}</div>`).join('')}</div>
                         </div>
                         <div class="flex items-center gap-4 p-5 rounded-2xl bg-theme-card border border-theme-border shadow-sm hover:shadow-md transition">
                            <div class="w-10 h-10 rounded-full bg-blue-50 text-blue-500 flex items-center justify-center shrink-0"><i class="fa fa-envelope"></i></div>
                            <div><div class="text-xs text-theme-muted uppercase font-bold tracking-wider mb-1">${cl.email}</div><div class="text-theme-title font-medium">${basic.email}</div></div>
                         </div>
                         <div class="flex items-center gap-4 p-5 rounded-2xl bg-theme-card border border-theme-border shadow-sm hover:shadow-md transition">
                            <div class="w-10 h-10 rounded-full bg-green-50 text-green-500 flex items-center justify-center shrink-0"><i class="fa fa-map-marker"></i></div>
                            <div><div class="text-xs text-theme-muted uppercase font-bold tracking-wider mb-1">${cl.location}</div><div class="text-theme-title font-medium">${basic.location}</div></div>
                         </div>
                    </div>
                    <form class="h-full flex flex-col gap-4" action="${formAction}" method="POST" ${onSubmitAttr}>
                        <input type="text" name="name" placeholder="${cf.label_name}" class="w-full px-5 py-3 bg-theme-card border border-theme-border rounded-xl focus:outline-none focus:border-theme-accent focus:ring-2 focus:ring-blue-500/20 transition-all text-theme-title" required>
                        <input type="email" name="email" placeholder="${cf.label_email}" class="w-full px-5 py-3 bg-theme-card border border-theme-border rounded-xl focus:outline-none focus:border-theme-accent focus:ring-2 focus:ring-blue-500/20 transition-all text-theme-title" required>
                        <textarea name="message" class="w-full px-5 py-3 bg-theme-card border border-theme-border rounded-xl focus:outline-none focus:border-theme-accent focus:ring-2 focus:ring-blue-500/20 transition-all flex-1 resize-none text-theme-title" placeholder="${cf.label_msg}" required></textarea>
                        <button type="submit" class="w-full btn-main py-3 font-medium hover:opacity-80 transition-all transform hover:scale-[1.02] shadow-lg">${cf.btn_send}</button>
                    </form>
                </div>`;

            document.getElementById('f-name').textContent = basic.name;
            document.getElementById('f-desc').textContent = basic.footer_text;
            document.getElementById('social-icons').innerHTML = basic.social_links.map(s => {
                const btnClass = "w-10 h-10 rounded-full bg-theme-card text-theme-muted hover:bg-black hover:text-white flex items-center justify-center transition-all duration-300 transform hover:-translate-y-1 shadow-sm";
                if(s.type === 'modal') return `<button onclick="showModal('${s.modal_img}', '${s.modal_text}')" class="${btnClass}"><i class="fa ${s.icon}"></i></button>`;
                return `<a href="${s.url}" target="_blank" class="${btnClass}"><i class="fa ${s.icon}"></i></a>`;
            }).join('');
        }
        
        window.showModal = (img, text) => {
            document.getElementById('modal-qr').src = img; document.getElementById('modal-text').textContent = text;
            const isZh = currentLang === 'zh'; document.getElementById('modal-title').textContent = isZh ? 'æ‰«æäºŒç»´ç ' : 'Scan QR Code';
            document.getElementById('wechatModal').classList.remove('hidden');
        }

        // Print view remains standardized black & white
        function renderPrintView(data, ui) {
            const basic = data.basic_info; const st = ui.section_titles;
            const separator = currentLang === 'zh' ? 'ï¼›' : '; ';
            const matrixRows = (data.skills.card_groups || []).map(group => `<tr><td style="font-weight: bold;">${group.title}</td><td>${group.items.join(separator)}</td></tr>`).join('');
            const toolsHtml = data.tools.map(t => `<li><strong>${t.group}ï¼š</strong> ${t.list.join(', ')}</li>`).join('');

            let html = `
                <div class="print-h1">${basic.name}</div>
                <div class="print-meta"><ul class="print-list" style="margin:0; padding-left: 1.2rem;"><li><strong>${basic.objective.label}ï¼š</strong> ${basic.objective.items.join(' | ')}</li><li><strong>${data.ui.contact_labels.location}ï¼š</strong> ${basic.location.split('.')[0]} | <strong>${data.ui.contact_labels.email}ï¼š</strong> ${basic.email}</li></ul></div>
                <div class="print-section"><div class="print-h2">${st.profile}</div><div style="text-align: justify;">${data.profile.summary}</div></div>
                <div class="print-section"><div class="print-h2">${st.skills}</div><table class="print-table"><thead><tr><th width="18%">${currentLang === 'zh' ? 'èƒ½åŠ›ç±»åˆ«' : 'Category'}</th><th>${currentLang === 'zh' ? 'æ ¸å¿ƒå†…å®¹' : 'Core Competencies'}</th></tr></thead><tbody>${matrixRows}</tbody></table></div>
                <div class="print-section"><div class="print-h2">${st.experience}</div>${data.experience.map(exp => `<div class="no-break"><div class="print-h3"><span>${exp.company}</span></div><div class="job-sub-row"><span>${exp.role}</span><span>${exp.location} | ${exp.date}</span></div>${exp.projects.map(p => `<div style="margin-top: 0.5rem;">${p.title ? `<div class="job-phase-title">${p.title}</div>` : ''}<ul class="print-list">${p.details.map(d => `<li>${d}</li>`).join('')}</ul></div>`).join('')}</div>`).join('')}</div>
                <div class="print-section no-break"><div class="print-h2">${st.education}</div>${data.education.map(edu => `<div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem; font-size: 9.5pt;"><div><strong>${edu.school}</strong> | ${edu.degree}</div><div>${edu.location} | ${edu.date}</div></div>`).join('')}</div>
                <div class="print-section no-break"><div class="print-h2">${currentLang === 'zh' ? 'æŠ€èƒ½ä¸å…´è¶£' : 'Skills & Interests'}</div><ul class="print-list">${toolsHtml}<li><strong>${st.hobbies}ï¼š</strong> ${data.hobbies.items.join('ã€')}ï¼Œ${data.hobbies.desc}</li></ul></div>
            `;
            document.getElementById('print-view').innerHTML = html;
        }
    </script>
</body>
</html>
